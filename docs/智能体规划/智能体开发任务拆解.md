# 智能体开发任务拆解（可分配给不同工程师）

目标：每个智能体有清晰输入/输出、V1 交付项、关键接口和验收标准，方便并行开发。

## 共性要求（所有智能体）
- 数据格式：统一使用 WGS84，经纬度双精度；时间窗 ISO 8601；几何支持 line/polygon/raster。硬/软、来源、置信度字段必填。
- 错误处理：硬约束命中返回可解释错误码；禁止直线兜底。
- 审计：记录来源、决策理由、豁免开关状态。

## 智能体 A：感知与障碍标注
- 输入：卫星/无人机切片、人工上报（坐标+类型+时间窗+置信度）、指挥中心事件流。
- 输出：`list_obstacles(time_window, bbox)` → `{segments, polygons, grid, metadata}`，标记硬/软、来源、置信度。
- V1 交付：
  - 定义障碍 schema（线/面/栅格，hard/soft，time_window，source，confidence）。
  - 接入至少一种数据源（人工上报或已有 DB），提供 REST/GraphQL/LangGraph node 查询。
  - 缓存与分页，支持 bbox/time_window 过滤。
- 验收：能返回含硬/软标签的障碍集合；缺数据时显式为空，不造假。

## 智能体 B：能力建模
- 输入：平台 ID/类型；可选健康状态/载荷/技能上报。
- 输出：`get_capability(id|type)` → capability_profile（宽度、轴重、转弯、坡度/侧倾、涉水、续航/航时、抗风、载荷/装备/技能、编组策略）。
- V1 交付：
  - 定义能力 schema；缺项即报错，不兜底 light_vehicle。
  - 落地存储/配置加载（DB/YAML 任选），暴露查询接口。
  - 单元测试覆盖字段缺失/类型错误。
- 验收：查询返回完整字段，缺失时报错；不同平台类型返回差异化参数。

## 智能体 C：路径规划（地/空/水，K-best，二段投送）
- 输入：`plan_paths(request)`，含起终点/waypoints、平台能力、时间窗、障碍集（来自 A）、豁免开关。
- 输出：`paths:[{points,cost,risks,violated_soft,metrics}]`，至少 2 条（最优+备选）。
- V1 交付：
  - 重写代价函数：地面(坡度/地表/封控/灾害热度)、空域(禁飞/限高/风/LoS)、水域(水深/航道)。硬障碍=∞，软=惩罚。
  - K-best=2；waypoint 分段支持二段投送；不可行边过滤。
  - 审计：列出命中的硬/软、豁免原因。
- 验收：给定含硬障碍的场景，返回无穿越的路径；K-best 提供不同边集；豁免开关关闭时不可穿越软区。

## 智能体 D：调度与分配（OR-Tools）
- 输入：任务列表（需求/时间窗/优先级/技能）、平台列表（能力/起点）、成本矩阵（由 C 计算，不可行=∞）。
- 输出：任务-平台分配与访问顺序、ETA、调用路径规划的路径引用。
- V1 交付：
  - VRP 带时间窗、容量/技能匹配；使用可行性过滤后的成本矩阵。
  - 支持优先级/权重；输出调度结果与不可行原因。
  - 简单 K-best：禁用上一条部分边后再求一次次优。
- 验收：给定小型任务集能在限定时间内返回分配；不可行任务有明确原因；与 C 耦合可生成完整路线。

## 智能体 E：评估与解释
- 输入：来自 C/D 的路径与分配结果、障碍/豁免记录。
- 输出：风险列表、命中约束、豁免审批链、geojson/tiles 可视化引用、审计日志。
- V1 交付：
  - 汇总最优+备选的风险与软/硬命中；生成审计条目。
  - 无解/高风险时提示“最接近可行”的放宽建议。
- 验收：能为每条路径列出约束命中和豁免；生成可消费的审计 JSON；高风险场景有告警。

## 里程碑（可平行分配）
- 里程碑 1（1-2 周）：A schema+查询、B schema+查询、C 代价函数+K-best=2、D 基础 VRP、E 审计汇总。
- 里程碑 2（2-4 周）：车队/编组校验、二段前置关系、多技能/装备调度、可视化、豁免审计完善。
- 里程碑 3（>4 周）：动态重规划/成本增量刷新、性能优化、执行监控闭环、数据质量控制与人工校核流。
