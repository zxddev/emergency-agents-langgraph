# æ•‘ç¾æ–¹æ¡ˆä¸ŠæŠ¥æ¥å£ - è”è°ƒæ–‡æ¡£

**æ¥å£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-02
**è´Ÿè´£äºº**: AIåº”æ€¥å¤§è„‘å›¢é˜Ÿ

---

## 1. æ¥å£æ¦‚è¿°

### 1.1 åŠŸèƒ½è¯´æ˜

æœ¬æ¥å£ç”¨äº**æ•‘ç¾ç°åœºå®æ—¶ä¸ŠæŠ¥**ï¼ŒåŸºäºç¾æƒ…æè¿°å¿«é€Ÿç”Ÿæˆç»“æ„åŒ–çš„æ•‘æ´æ–¹æ¡ˆå»ºè®®ã€‚é€‚ç”¨äºç¾å®³å‘ç”Ÿåçš„ç´§æ€¥å“åº”é˜¶æ®µï¼Œç”±ä¸€çº¿æŒ‡æŒ¥äººå‘˜æˆ–ä¿¡æ¯å‘˜é€šè¿‡è¯­éŸ³/æ–‡å­—ä¸ŠæŠ¥ç¾æƒ…ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ•‘æ´è¡ŒåŠ¨æ–¹æ¡ˆã€‚

**æ ¸å¿ƒèƒ½åŠ›**:
- âœ… ä»éç»“æ„åŒ–æ–‡æœ¬ä¸­æå–ç¾æƒ…è¦ç´ ï¼ˆåœ°ç‚¹ã€ç±»å‹ã€ä¸¥é‡ç¨‹åº¦ç­‰ï¼‰
- âœ… è‡ªåŠ¨åŒ¹é…åº”æ€¥é¢„æ¡ˆå’Œå†å²æ¡ˆä¾‹
- âœ… ç”ŸæˆåŒ…å«è¡ŒåŠ¨æ­¥éª¤ã€è£…å¤‡éœ€æ±‚ã€é£é™©æç¤ºçš„å®Œæ•´æ–¹æ¡ˆ
- âœ… æä¾›å¤šä¸ªå¯é€‰æ–¹æ¡ˆä¾›å†³ç­–å‚è€ƒ

**ä½¿ç”¨åœºæ™¯**:
- ğŸ”¥ ç¾å®³ç°åœºä¸€çº¿äººå‘˜å¿«é€Ÿä¸ŠæŠ¥
- ğŸ“ åº”æ€¥æŒ‡æŒ¥ä¸­å¿ƒæ¥æ”¶ç¾æƒ…æŠ¥å‘Š
- ğŸ™ï¸ è¯­éŸ³è½¬æ–‡å­—åçš„ç¾æƒ…å¤„ç†
- ğŸ“± ç§»åŠ¨ç«¯ç°åœºé‡‡é›†

---

## 2. æ¥å£ä¿¡æ¯

### 2.1 åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **æ¥å£åœ°å€** | `POST /reports/rescue-assessment` |
| **è¯·æ±‚æ–¹å¼** | POST |
| **Content-Type** | application/json |
| **è¶…æ—¶æ—¶é—´** | å»ºè®®120ç§’ |
| **é‰´æƒæ–¹å¼** | (æ ¹æ®å®é™…éƒ¨ç½²é…ç½®) |

### 2.2 ç¯å¢ƒåœ°å€

| ç¯å¢ƒ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| å¼€å‘ç¯å¢ƒ | `http://localhost:8008` | æœ¬åœ°å¼€å‘ |
| æµ‹è¯•ç¯å¢ƒ | `http://test-server:8008` | è”è°ƒæµ‹è¯• |
| ç”Ÿäº§ç¯å¢ƒ | `https://api.emergency.cn` | æ­£å¼ç¯å¢ƒ |

---

## 3. è¯·æ±‚å‚æ•°

### 3.1 è¯·æ±‚ä½“ï¼ˆBodyï¼‰

**Content-Type**: `application/json`

```json
{
  "disaster_type": "string",      // å¿…å¡«ï¼Œç¾å®³ç±»å‹
  "location": "string",            // å¿…å¡«ï¼Œç¾å®³åœ°ç‚¹
  "severity": "string",            // å¿…å¡«ï¼Œä¸¥é‡ç¨‹åº¦
  "description": "string",         // å¿…å¡«ï¼Œç¾æƒ…æè¿°
  "casualties_estimated": "number", // å¯é€‰ï¼Œé¢„ä¼°ä¼¤äº¡äººæ•°
  "affected_population": "number",  // å¯é€‰ï¼Œå—å½±å“äººå£
  "infrastructure_damage": "string", // å¯é€‰ï¼ŒåŸºç¡€è®¾æ–½æŸæ¯æƒ…å†µ
  "weather_conditions": "string",   // å¯é€‰ï¼Œå¤©æ°”æ¡ä»¶
  "accessibility": "string"         // å¯é€‰ï¼Œäº¤é€šå¯è¾¾æ€§
}
```

### 3.2 å­—æ®µè¯¦ç»†è¯´æ˜

#### å¿…å¡«å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ | çº¦æŸ |
|------|------|------|------|------|
| **disaster_type** | string | ç¾å®³ç±»å‹ | "åœ°éœ‡" | æšä¸¾å€¼è§ä¸‹è¡¨ |
| **location** | string | ç¾å®³åœ°ç‚¹ï¼ˆè¯¦ç»†åœ°å€ï¼‰ | "å››å·çœé›…å®‰å¸‚èŠ¦å±±å¿é¾™é—¨ä¹¡" | 2-200å­—ç¬¦ |
| **severity** | string | ä¸¥é‡ç¨‹åº¦ | "é‡å¤§" | æšä¸¾å€¼è§ä¸‹è¡¨ |
| **description** | string | ç¾æƒ…æè¿°ï¼ˆè¯¦ç»†æ–‡æœ¬ï¼‰ | "éœ‡çº§7.0ï¼Œæˆ¿å±‹å¤§é‡å€’å¡Œï¼Œäººå‘˜è¢«å›°..." | 10-2000å­—ç¬¦ |

**disaster_type æšä¸¾å€¼**:
```
- åœ°éœ‡
- æ´ªæ°´
- å±±ä½“æ»‘å¡
- æ³¥çŸ³æµ
- æ£®æ—ç«ç¾
- åŒ–å·¥çˆ†ç‚¸
- å±åŒ–å“æ³„æ¼
- å»ºç­‘å€’å¡Œ
- çŸ¿éš¾
- å…¶ä»–
```

**severity æšä¸¾å€¼**:
```
- ç‰¹åˆ«é‡å¤§ï¼ˆâ… çº§ï¼‰: æ­»äº¡30äººä»¥ä¸Šæˆ–å¤±è¸ª100äººä»¥ä¸Š
- é‡å¤§ï¼ˆâ…¡çº§ï¼‰: æ­»äº¡10-29äººæˆ–å¤±è¸ª50-99äºº
- è¾ƒå¤§ï¼ˆâ…¢çº§ï¼‰: æ­»äº¡3-9äººæˆ–å¤±è¸ª10-49äºº
- ä¸€èˆ¬ï¼ˆâ…£çº§ï¼‰: æ­»äº¡1-2äººæˆ–å¤±è¸ª1-9äºº
```

#### å¯é€‰å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ | é»˜è®¤å€¼ |
|------|------|------|------|--------|
| **casualties_estimated** | number | é¢„ä¼°ä¼¤äº¡äººæ•° | 50 | 0 |
| **affected_population** | number | å—å½±å“äººå£ | 10000 | 0 |
| **infrastructure_damage** | string | åŸºç¡€è®¾æ–½æŸæ¯ | "é“è·¯ä¸­æ–­3å¤„ï¼Œæ¡¥æ¢åå¡Œ1åº§" | "" |
| **weather_conditions** | string | å¤©æ°”æ¡ä»¶ | "ä¸­é›¨ï¼Œèƒ½è§åº¦50ç±³" | "" |
| **accessibility** | string | äº¤é€šå¯è¾¾æ€§ | "ä¸»å¹²é“ç•…é€šï¼Œå±±åŒºé“è·¯ä¸­æ–­" | "" |

---

## 4. å“åº”å‚æ•°

### 4.1 æˆåŠŸå“åº”ï¼ˆHTTP 200ï¼‰

```json
{
  "situation": {
    "disaster_type": "string",
    "location": "string",
    "severity": "string",
    "description": "string",
    "estimated_casualties": "number",
    "affected_population": "number",
    "infrastructure_damage": "string",
    "weather_conditions": "string",
    "accessibility": "string"
  },
  "rescue_plan": "string",           // Markdownæ ¼å¼çš„æ•‘æ´æ–¹æ¡ˆ
  "recommended_equipment": [          // æ¨èè£…å¤‡æ¸…å•
    {
      "equipment_name": "string",
      "category": "string",
      "quantity": "number",
      "urgency": "number",
      "reason": "string"
    }
  ],
  "similar_cases": [                  // ç›¸ä¼¼å†å²æ¡ˆä¾‹
    {
      "case_id": "string",
      "title": "string",
      "similarity_score": "number",
      "key_lessons": "string"
    }
  ],
  "confidence_score": "number",       // 0-1ï¼Œæ–¹æ¡ˆç½®ä¿¡åº¦
  "data_sources": ["string"],         // æ•°æ®æ¥æºåˆ—è¡¨
  "warnings": ["string"]              // é£é™©è­¦ç¤º
}
```

### 4.2 å­—æ®µè¯¦ç»†è¯´æ˜

#### situationï¼ˆæ€åŠ¿ä¿¡æ¯ï¼‰

ç»“æ„åŒ–åçš„ç¾æƒ…æ•°æ®ï¼Œä¸è¾“å…¥åŸºæœ¬ä¸€è‡´ï¼Œä½†ç»è¿‡LLMç†è§£å’Œè§„èŒƒåŒ–ã€‚

#### rescue_planï¼ˆæ•‘æ´æ–¹æ¡ˆï¼‰

**æ ¼å¼**: Markdownæ–‡æœ¬ï¼ŒåŒ…å«ä»¥ä¸‹ç« èŠ‚ï¼š

1. **æ€åŠ¿è¯„ä¼°**: ç¾å®³æ€§è´¨ã€å½±å“èŒƒå›´ã€ç´§è¿«æ€§åˆ†æ
2. **æ•‘æ´ç›®æ ‡**: ä¸»è¦ç›®æ ‡ï¼ˆäººå‘˜æœæ•‘ã€ç¾æ°‘å®‰ç½®ç­‰ï¼‰
3. **è¡ŒåŠ¨æ­¥éª¤**: åˆ†é˜¶æ®µã€åˆ†ä¼˜å…ˆçº§çš„å…·ä½“è¡ŒåŠ¨
4. **åŠ›é‡è°ƒåº¦**: éœ€è¦è°ƒåŠ¨çš„æ•‘æ´é˜Ÿä¼å’Œèµ„æº
5. **è£…å¤‡éœ€æ±‚**: å…³é”®è£…å¤‡æ¸…å•åŠç”¨é€”
6. **é£é™©æç¤º**: æ¬¡ç”Ÿç¾å®³é£é™©ã€å®‰å…¨æ³¨æ„äº‹é¡¹
7. **é€šä¿¡åè°ƒ**: æŒ‡æŒ¥ä½“ç³»ã€é€šä¿¡æ–¹å¼

**ç¤ºä¾‹**:
```markdown
# æ•‘æ´è¡ŒåŠ¨æ–¹æ¡ˆ

## ä¸€ã€æ€åŠ¿è¯„ä¼°
æœ¬æ¬¡åœ°éœ‡ä¸º7.0çº§ï¼Œéœ‡ä¸­ä½äºäººå£å¯†é›†åŒº...

## äºŒã€æ•‘æ´ç›®æ ‡
1. 72å°æ—¶å†…å®Œæˆé‡ç‚¹åŒºåŸŸæœæ•‘
2. 24å°æ—¶å†…è½¬ç§»å—å¨èƒç¾¤ä¼—
...
```

#### recommended_equipmentï¼ˆæ¨èè£…å¤‡ï¼‰

åŸºäºKGçŸ¥è¯†å›¾è°±æ¨èçš„è£…å¤‡æ¸…å•ã€‚

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| equipment_name | è£…å¤‡åç§° | "ç”Ÿå‘½æ¢æµ‹ä»ª" |
| category | è£…å¤‡åˆ†ç±» | "æœæ•‘ç±»" |
| quantity | æ¨èæ•°é‡ | 10 |
| urgency | ç´§æ€¥ç¨‹åº¦ï¼ˆ0-1ï¼‰ | 0.95 |
| reason | æ¨èç†ç”± | "åœ°éœ‡æœæ•‘å¿…å¤‡ï¼Œç”¨äºæ¢æµ‹è¢«å›°äººå‘˜" |

#### similar_casesï¼ˆç›¸ä¼¼æ¡ˆä¾‹ï¼‰

ä»çŸ¥è¯†å›¾è°±æ£€ç´¢çš„å†å²æ¡ˆä¾‹ã€‚

| å­—æ®µ | è¯´æ˜ |
|------|------|
| case_id | æ¡ˆä¾‹ID |
| title | æ¡ˆä¾‹æ ‡é¢˜ |
| similarity_score | ç›¸ä¼¼åº¦ï¼ˆ0-1ï¼‰ |
| key_lessons | å…³é”®ç»éªŒæ•™è®­ |

#### confidence_scoreï¼ˆç½®ä¿¡åº¦ï¼‰

**è®¡ç®—è§„åˆ™**:
```
ç½®ä¿¡åº¦ = (è¾“å…¥å®Œæ•´åº¦ Ã— 0.3) + (åŒ¹é…æ¡ˆä¾‹æ•° Ã— 0.2) + (è£…å¤‡æ¨èæ•° Ã— 0.2) + (LLMè¾“å‡ºè´¨é‡ Ã— 0.3)
```

| åˆ†æ•°èŒƒå›´ | å«ä¹‰ | å»ºè®® |
|---------|------|------|
| 0.8-1.0 | é«˜ç½®ä¿¡åº¦ | å¯ç›´æ¥å‚è€ƒ |
| 0.6-0.79 | ä¸­ç­‰ç½®ä¿¡åº¦ | éœ€äººå·¥å®¡æ ¸ |
| 0-0.59 | ä½ç½®ä¿¡åº¦ | ä»…ä¾›å‚è€ƒ |

---

## 5. é”™è¯¯ç è¯´æ˜

### 5.1 HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ | åŸå›  |
|--------|------|------|
| 200 | æˆåŠŸ | æ­£å¸¸è¿”å› |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | ç¼ºå°‘å¿…å¡«å­—æ®µæˆ–æ ¼å¼é”™è¯¯ |
| 422 | æ•°æ®éªŒè¯å¤±è´¥ | Pydanticæ ¡éªŒä¸é€šè¿‡ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | LLMè°ƒç”¨å¤±è´¥æˆ–å…¶ä»–å¼‚å¸¸ |
| 502 | Bad Gateway | LLMè¿”å›ç©ºæˆ–è¶…æ—¶ |
| 504 | Gateway Timeout | è¯·æ±‚è¶…è¿‡120ç§’ |

### 5.2 ä¸šåŠ¡é”™è¯¯ç 

```json
{
  "detail": "é”™è¯¯æè¿°",
  "error_code": "BUSINESS_ERROR_CODE",
  "trace_id": "uuid-xxx"
}
```

| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|---------|
| `INVALID_DISASTER_TYPE` | ä¸æ”¯æŒçš„ç¾å®³ç±»å‹ | æ£€æŸ¥disaster_typeæšä¸¾å€¼ |
| `DESCRIPTION_TOO_SHORT` | æè¿°è¿‡äºç®€çŸ­ | æä¾›è‡³å°‘10å­—ç¬¦çš„æè¿° |
| `LLM_CALL_FAILED` | LLMè°ƒç”¨å¤±è´¥ | ç¨åé‡è¯•æˆ–è”ç³»ç®¡ç†å‘˜ |
| `KG_SERVICE_UNAVAILABLE` | çŸ¥è¯†å›¾è°±æœåŠ¡ä¸å¯ç”¨ | é™çº§å¤„ç†ï¼Œä¸å½±å“ä¸»æµç¨‹ |

---

## 6. å®Œæ•´è°ƒç”¨ç¤ºä¾‹

### 6.1 æœ€å°è¯·æ±‚ç¤ºä¾‹

```bash
curl -X POST http://localhost:8008/reports/rescue-assessment \
  -H "Content-Type: application/json" \
  -d '{
    "disaster_type": "åœ°éœ‡",
    "location": "å››å·çœé›…å®‰å¸‚",
    "severity": "é‡å¤§",
    "description": "7.0çº§åœ°éœ‡ï¼Œæˆ¿å±‹å€’å¡Œä¸¥é‡ï¼Œäººå‘˜è¢«å›°"
  }'
```

### 6.2 å®Œæ•´è¯·æ±‚ç¤ºä¾‹

```bash
curl -X POST http://localhost:8008/reports/rescue-assessment \
  -H "Content-Type: application/json" \
  -d '{
    "disaster_type": "åœ°éœ‡",
    "location": "å››å·çœé›…å®‰å¸‚èŠ¦å±±å¿é¾™é—¨ä¹¡",
    "severity": "ç‰¹åˆ«é‡å¤§",
    "description": "2025å¹´4æœˆ20æ—¥8æ—¶02åˆ†ï¼Œé›…å®‰å¸‚èŠ¦å±±å¿å‘ç”Ÿ7.0çº§åœ°éœ‡ï¼Œéœ‡æºæ·±åº¦13å…¬é‡Œã€‚éœ‡ä¸­ä½äºäººå£å¯†é›†åŒºï¼Œæˆ¿å±‹å¤§é‡å€’å¡Œï¼Œé€šä¿¡ä¸­æ–­ï¼Œé“è·¯æŸæ¯ä¸¥é‡ã€‚åˆæ­¥ç»Ÿè®¡ï¼Œå·²æœ‰100ä½™äººè¢«å›°ï¼Œä¼¤äº¡æƒ…å†µä¸æ˜ã€‚ä½™éœ‡é¢‘ç¹ï¼Œå­˜åœ¨æ¬¡ç”Ÿç¾å®³é£é™©ã€‚",
    "casualties_estimated": 100,
    "affected_population": 50000,
    "infrastructure_damage": "ä¸»å¹²é“ä¸­æ–­5å¤„ï¼Œæ¡¥æ¢åå¡Œ2åº§ï¼Œé€šä¿¡åŸºç«™æŸæ¯65%",
    "weather_conditions": "é˜´å¤©ï¼Œæ°”æ¸©12Â°Cï¼Œé¢„è®¡æœªæ¥24å°æ—¶æœ‰å°é›¨",
    "accessibility": "çœé“å¯é€šè¡Œï¼Œä¹¡æ‘é“è·¯å¤šå¤„ä¸­æ–­ï¼Œå»ºè®®ç©ºä¸­æ•‘æ´"
  }'
```

### 6.3 æˆåŠŸå“åº”ç¤ºä¾‹

```json
{
  "situation": {
    "disaster_type": "åœ°éœ‡",
    "location": "å››å·çœé›…å®‰å¸‚èŠ¦å±±å¿é¾™é—¨ä¹¡",
    "severity": "ç‰¹åˆ«é‡å¤§",
    "description": "2025å¹´4æœˆ20æ—¥8æ—¶02åˆ†ï¼Œé›…å®‰å¸‚èŠ¦å±±å¿å‘ç”Ÿ7.0çº§åœ°éœ‡...",
    "estimated_casualties": 100,
    "affected_population": 50000,
    "infrastructure_damage": "ä¸»å¹²é“ä¸­æ–­5å¤„ï¼Œæ¡¥æ¢åå¡Œ2åº§...",
    "weather_conditions": "é˜´å¤©ï¼Œæ°”æ¸©12Â°Cï¼Œé¢„è®¡æœªæ¥24å°æ—¶æœ‰å°é›¨",
    "accessibility": "çœé“å¯é€šè¡Œï¼Œä¹¡æ‘é“è·¯å¤šå¤„ä¸­æ–­ï¼Œå»ºè®®ç©ºä¸­æ•‘æ´"
  },
  "rescue_plan": "# æ•‘æ´è¡ŒåŠ¨æ–¹æ¡ˆ\n\n## ä¸€ã€æ€åŠ¿è¯„ä¼°\n\næœ¬æ¬¡åœ°éœ‡ä¸º7.0çº§...",
  "recommended_equipment": [
    {
      "equipment_name": "ç”Ÿå‘½æ¢æµ‹ä»ª",
      "category": "æœæ•‘ç±»",
      "quantity": 20,
      "urgency": 0.95,
      "reason": "åœ°éœ‡æœæ•‘å¿…å¤‡è£…å¤‡ï¼Œç”¨äºæ¢æµ‹åºŸå¢Ÿä¸‹è¢«å›°äººå‘˜"
    },
    {
      "equipment_name": "æ¶²å‹ç ´æ‹†å·¥å…·",
      "category": "ç ´æ‹†ç±»",
      "quantity": 30,
      "urgency": 0.9,
      "reason": "ç”¨äºç ´æ‹†å€’å¡Œå»ºç­‘ï¼Œå¼€è¾Ÿæ•‘æ´é€šé“"
    }
  ],
  "similar_cases": [
    {
      "case_id": "case_2013_yaan",
      "title": "2013å¹´é›…å®‰7.0çº§åœ°éœ‡æ•‘æ´",
      "similarity_score": 0.92,
      "key_lessons": "72å°æ—¶é»„é‡‘æ•‘æ´æœŸå†…æˆåŠŸæ•‘å‡º127äººï¼Œç©ºä¸­æ•‘æ´å‘æŒ¥å…³é”®ä½œç”¨"
    }
  ],
  "confidence_score": 0.87,
  "data_sources": [
    "RAGè§„èŒƒåº“",
    "çŸ¥è¯†å›¾è°±æ¡ˆä¾‹åº“",
    "è£…å¤‡æ¨èç³»ç»Ÿ"
  ],
  "warnings": [
    "ä½™éœ‡é£é™©é«˜ï¼Œæ•‘æ´äººå‘˜éœ€æ³¨æ„å®‰å…¨",
    "å¤©æ°”è½¬é›¨ï¼Œæ³¨æ„æ¬¡ç”Ÿå±±ä½“æ»‘å¡é£é™©",
    "é€šä¿¡ä¸­æ–­ï¼Œå»ºè®®ä½¿ç”¨å«æ˜Ÿç”µè¯"
  ]
}
```

---

## 7. å‰ç«¯é›†æˆç¤ºä¾‹

### 7.1 Vue 3 + Axios

```vue
<template>
  <div>
    <el-form :model="form" ref="formRef" :rules="rules">
      <el-form-item label="ç¾å®³ç±»å‹" prop="disaster_type">
        <el-select v-model="form.disaster_type" placeholder="è¯·é€‰æ‹©">
          <el-option label="åœ°éœ‡" value="åœ°éœ‡" />
          <el-option label="æ´ªæ°´" value="æ´ªæ°´" />
          <el-option label="å±±ä½“æ»‘å¡" value="å±±ä½“æ»‘å¡" />
        </el-select>
      </el-form-item>

      <el-form-item label="ç¾å®³åœ°ç‚¹" prop="location">
        <el-input v-model="form.location" />
      </el-form-item>

      <el-form-item label="ä¸¥é‡ç¨‹åº¦" prop="severity">
        <el-radio-group v-model="form.severity">
          <el-radio label="ç‰¹åˆ«é‡å¤§" />
          <el-radio label="é‡å¤§" />
          <el-radio label="è¾ƒå¤§" />
          <el-radio label="ä¸€èˆ¬" />
        </el-radio-group>
      </el-form-item>

      <el-form-item label="ç¾æƒ…æè¿°" prop="description">
        <el-input
          type="textarea"
          v-model="form.description"
          :rows="5"
          placeholder="è¯·è¯¦ç»†æè¿°ç¾æƒ…..."
        />
      </el-form-item>

      <el-button
        type="primary"
        :loading="loading"
        @click="submitForm"
      >
        {{ loading ? 'ç”Ÿæˆä¸­...' : 'ç”Ÿæˆæ•‘æ´æ–¹æ¡ˆ' }}
      </el-button>
    </el-form>

    <!-- æ˜¾ç¤ºç»“æœ -->
    <div v-if="result" class="result-panel">
      <el-card>
        <template #header>
          <span>æ•‘æ´æ–¹æ¡ˆ</span>
          <el-tag :type="getConfidenceType(result.confidence_score)">
            ç½®ä¿¡åº¦: {{ (result.confidence_score * 100).toFixed(0) }}%
          </el-tag>
        </template>

        <div v-html="renderMarkdown(result.rescue_plan)" />

        <el-divider />

        <h4>æ¨èè£…å¤‡ ({{ result.recommended_equipment.length }})</h4>
        <el-table :data="result.recommended_equipment">
          <el-table-column prop="equipment_name" label="è£…å¤‡åç§°" />
          <el-table-column prop="quantity" label="æ•°é‡" width="80" />
          <el-table-column prop="urgency" label="ç´§æ€¥åº¦" width="100">
            <template #default="{ row }">
              <el-progress
                :percentage="row.urgency * 100"
                :color="row.urgency > 0.8 ? '#F56C6C' : '#E6A23C'"
              />
            </template>
          </el-table-column>
        </el-table>

        <el-divider />

        <h4>ç›¸ä¼¼æ¡ˆä¾‹ ({{ result.similar_cases.length }})</h4>
        <el-timeline>
          <el-timeline-item
            v-for="case in result.similar_cases"
            :key="case.case_id"
          >
            <strong>{{ case.title }}</strong>
            <p>{{ case.key_lessons }}</p>
          </el-timeline-item>
        </el-timeline>

        <el-alert
          v-for="warning in result.warnings"
          :key="warning"
          :title="warning"
          type="warning"
          :closable="false"
          style="margin-top: 10px"
        />
      </el-card>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue'
import axios from 'axios'
import MarkdownIt from 'markdown-it'

const md = new MarkdownIt()
const formRef = ref()
const loading = ref(false)
const result = ref(null)

const form = reactive({
  disaster_type: '',
  location: '',
  severity: '',
  description: '',
  casualties_estimated: null,
  affected_population: null
})

const rules = {
  disaster_type: [{ required: true, message: 'è¯·é€‰æ‹©ç¾å®³ç±»å‹' }],
  location: [{ required: true, message: 'è¯·è¾“å…¥ç¾å®³åœ°ç‚¹' }],
  severity: [{ required: true, message: 'è¯·é€‰æ‹©ä¸¥é‡ç¨‹åº¦' }],
  description: [
    { required: true, message: 'è¯·è¾“å…¥ç¾æƒ…æè¿°' },
    { min: 10, message: 'æè¿°è‡³å°‘10ä¸ªå­—ç¬¦' }
  ]
}

const submitForm = async () => {
  await formRef.value.validate()

  loading.value = true
  try {
    const response = await axios.post(
      'http://localhost:8008/reports/rescue-assessment',
      form,
      { timeout: 120000 } // 120ç§’è¶…æ—¶
    )

    result.value = response.data
    ElMessage.success('æ–¹æ¡ˆç”ŸæˆæˆåŠŸ')

  } catch (error) {
    console.error(error)
    ElMessage.error(error.response?.data?.detail || 'ç”Ÿæˆå¤±è´¥')
  } finally {
    loading.value = false
  }
}

const renderMarkdown = (text) => {
  return md.render(text)
}

const getConfidenceType = (score) => {
  if (score >= 0.8) return 'success'
  if (score >= 0.6) return 'warning'
  return 'danger'
}
</script>
```

### 7.2 React + TypeScript

```typescript
import React, { useState } from 'react';
import axios from 'axios';
import { Form, Input, Select, Button, Card, Table, Alert, Progress } from 'antd';
import ReactMarkdown from 'react-markdown';

interface RescueAssessmentRequest {
  disaster_type: string;
  location: string;
  severity: string;
  description: string;
  casualties_estimated?: number;
  affected_population?: number;
}

interface RescueAssessmentResponse {
  situation: any;
  rescue_plan: string;
  recommended_equipment: Array<{
    equipment_name: string;
    category: string;
    quantity: number;
    urgency: number;
    reason: string;
  }>;
  similar_cases: Array<{
    case_id: string;
    title: string;
    similarity_score: number;
    key_lessons: string;
  }>;
  confidence_score: number;
  data_sources: string[];
  warnings: string[];
}

const RescueAssessmentForm: React.FC = () => {
  const [form] = Form.useForm();
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState<RescueAssessmentResponse | null>(null);

  const onFinish = async (values: RescueAssessmentRequest) => {
    setLoading(true);
    try {
      const response = await axios.post<RescueAssessmentResponse>(
        'http://localhost:8008/reports/rescue-assessment',
        values,
        { timeout: 120000 }
      );
      setResult(response.data);
    } catch (error) {
      console.error(error);
      alert('ç”Ÿæˆå¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  const equipmentColumns = [
    { title: 'è£…å¤‡åç§°', dataIndex: 'equipment_name', key: 'equipment_name' },
    { title: 'æ•°é‡', dataIndex: 'quantity', key: 'quantity', width: 80 },
    {
      title: 'ç´§æ€¥åº¦',
      dataIndex: 'urgency',
      key: 'urgency',
      width: 150,
      render: (urgency: number) => (
        <Progress
          percent={urgency * 100}
          strokeColor={urgency > 0.8 ? '#ff4d4f' : '#faad14'}
        />
      ),
    },
  ];

  return (
    <div>
      <Form form={form} onFinish={onFinish} layout="vertical">
        <Form.Item
          label="ç¾å®³ç±»å‹"
          name="disaster_type"
          rules={[{ required: true, message: 'è¯·é€‰æ‹©ç¾å®³ç±»å‹' }]}
        >
          <Select placeholder="è¯·é€‰æ‹©">
            <Select.Option value="åœ°éœ‡">åœ°éœ‡</Select.Option>
            <Select.Option value="æ´ªæ°´">æ´ªæ°´</Select.Option>
            <Select.Option value="å±±ä½“æ»‘å¡">å±±ä½“æ»‘å¡</Select.Option>
          </Select>
        </Form.Item>

        <Form.Item
          label="ç¾å®³åœ°ç‚¹"
          name="location"
          rules={[{ required: true, message: 'è¯·è¾“å…¥ç¾å®³åœ°ç‚¹' }]}
        >
          <Input placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€" />
        </Form.Item>

        <Form.Item
          label="ä¸¥é‡ç¨‹åº¦"
          name="severity"
          rules={[{ required: true, message: 'è¯·é€‰æ‹©ä¸¥é‡ç¨‹åº¦' }]}
        >
          <Select placeholder="è¯·é€‰æ‹©">
            <Select.Option value="ç‰¹åˆ«é‡å¤§">ç‰¹åˆ«é‡å¤§</Select.Option>
            <Select.Option value="é‡å¤§">é‡å¤§</Select.Option>
            <Select.Option value="è¾ƒå¤§">è¾ƒå¤§</Select.Option>
            <Select.Option value="ä¸€èˆ¬">ä¸€èˆ¬</Select.Option>
          </Select>
        </Form.Item>

        <Form.Item
          label="ç¾æƒ…æè¿°"
          name="description"
          rules={[
            { required: true, message: 'è¯·è¾“å…¥ç¾æƒ…æè¿°' },
            { min: 10, message: 'æè¿°è‡³å°‘10ä¸ªå­—ç¬¦' },
          ]}
        >
          <Input.TextArea rows={5} placeholder="è¯·è¯¦ç»†æè¿°ç¾æƒ…..." />
        </Form.Item>

        <Button type="primary" htmlType="submit" loading={loading}>
          {loading ? 'ç”Ÿæˆä¸­...' : 'ç”Ÿæˆæ•‘æ´æ–¹æ¡ˆ'}
        </Button>
      </Form>

      {result && (
        <Card title="æ•‘æ´æ–¹æ¡ˆ" style={{ marginTop: 20 }}>
          <Alert
            message={`ç½®ä¿¡åº¦: ${(result.confidence_score * 100).toFixed(0)}%`}
            type={result.confidence_score >= 0.8 ? 'success' : 'warning'}
            showIcon
          />

          <div style={{ marginTop: 20 }}>
            <ReactMarkdown>{result.rescue_plan}</ReactMarkdown>
          </div>

          <h4 style={{ marginTop: 20 }}>æ¨èè£…å¤‡</h4>
          <Table
            dataSource={result.recommended_equipment}
            columns={equipmentColumns}
            rowKey="equipment_name"
            pagination={false}
          />

          {result.warnings.map((warning, index) => (
            <Alert
              key={index}
              message={warning}
              type="warning"
              style={{ marginTop: 10 }}
            />
          ))}
        </Card>
      )}
    </div>
  );
};

export default RescueAssessmentForm;
```

---

## 8. æ³¨æ„äº‹é¡¹

### 8.1 æ€§èƒ½æ³¨æ„äº‹é¡¹

1. **è¶…æ—¶è®¾ç½®**: å»ºè®®è®¾ç½®120ç§’è¶…æ—¶ï¼ŒLLMè°ƒç”¨å¯èƒ½éœ€è¦30-60ç§’
2. **å¹¶å‘é™åˆ¶**: ç”Ÿäº§ç¯å¢ƒå»ºè®®é™åˆ¶å¹¶å‘æ•°ï¼Œé¿å…LLMæœåŠ¡è¿‡è½½
3. **ç¼“å­˜ç­–ç•¥**: ç›¸åŒè¾“å…¥å¯ç¼“å­˜ç»“æœ30åˆ†é’Ÿï¼ˆç¾æƒ…å˜åŒ–æ—¶éœ€åˆ·æ–°ï¼‰

### 8.2 æ•°æ®è´¨é‡å»ºè®®

1. **æè¿°è¯¦ç»†åº¦**: æè¿°è¶Šè¯¦ç»†ï¼Œç”Ÿæˆçš„æ–¹æ¡ˆè¶Šç²¾å‡†
2. **å…³é”®ä¿¡æ¯**: åŠ¡å¿…åŒ…å«ï¼šæ—¶é—´ã€åœ°ç‚¹ã€ä¼¤äº¡ã€ç ´åç¨‹åº¦
3. **é¿å…æ¨¡ç³Šè¡¨è¿°**: ç”¨"æˆ¿å±‹å€’å¡Œ50æ ‹"è€Œé"æˆ¿å±‹å¤§é‡å€’å¡Œ"

### 8.3 é”™è¯¯å¤„ç†å»ºè®®

```javascript
try {
  const response = await axios.post(url, data, { timeout: 120000 });
  return response.data;
} catch (error) {
  if (error.code === 'ECONNABORTED') {
    // è¶…æ—¶å¤„ç†
    showMessage('ç”Ÿæˆè¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•');
  } else if (error.response?.status === 422) {
    // å‚æ•°éªŒè¯å¤±è´¥
    showMessage(error.response.data.detail);
  } else if (error.response?.status === 502) {
    // LLMè¿”å›ç©º
    showMessage('ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥åé‡è¯•');
  } else {
    // å…¶ä»–é”™è¯¯
    showMessage('ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜');
  }
}
```

### 8.4 å®‰å…¨æ³¨æ„äº‹é¡¹

1. **è¾“å…¥è¿‡æ»¤**: å‰ç«¯åº”è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»
2. **æ•°æ®è„±æ•**: æ•æ„Ÿä¿¡æ¯ï¼ˆäººåã€ç”µè¯ï¼‰åº”è„±æ•å¤„ç†
3. **æ—¥å¿—è®°å½•**: æ‰€æœ‰è¯·æ±‚éƒ½æœ‰trace_idï¼Œä¾¿äºé—®é¢˜è¿½è¸ª

---

## 9. æµ‹è¯•æ•°æ®

### 9.1 æµ‹è¯•ç”¨ä¾‹

**ç”¨ä¾‹1ï¼šåœ°éœ‡ç¾å®³ï¼ˆæœ€å°è¾“å…¥ï¼‰**
```json
{
  "disaster_type": "åœ°éœ‡",
  "location": "å››å·çœé›…å®‰å¸‚",
  "severity": "é‡å¤§",
  "description": "7.0çº§åœ°éœ‡ï¼Œæˆ¿å±‹å€’å¡Œä¸¥é‡ï¼Œäººå‘˜è¢«å›°"
}
```

**ç”¨ä¾‹2ï¼šæ´ªæ°´ç¾å®³ï¼ˆå®Œæ•´è¾“å…¥ï¼‰**
```json
{
  "disaster_type": "æ´ªæ°´",
  "location": "æ²³å—çœéƒ‘å·å¸‚é‡‘æ°´åŒº",
  "severity": "ç‰¹åˆ«é‡å¤§",
  "description": "ç‰¹å¤§æš´é›¨å¯¼è‡´å†…æ¶ï¼Œåœ°é“5å·çº¿è¢«æ·¹ï¼Œæ•°ç™¾äººè¢«å›°è½¦å¢ï¼Œå¤šä¸ªå°åŒºè¿›æ°´æ·±åº¦è¶…è¿‡2ç±³",
  "casualties_estimated": 50,
  "affected_population": 100000,
  "infrastructure_damage": "åœ°é“5å·çº¿å…¨çº¿åœè¿ï¼Œäº¬å¹¿è·¯éš§é“è¢«æ·¹ï¼Œä¾›ç”µä¸­æ–­",
  "weather_conditions": "æŒç»­æš´é›¨ï¼Œé¢„è®¡æœªæ¥6å°æ—¶ä»æœ‰å¤§é›¨",
  "accessibility": "ä¸»å¹²é“ç§¯æ°´ä¸¥é‡ï¼Œå»ºè®®ä½¿ç”¨æ•‘ç”Ÿè‰‡"
}
```

---

## 10. å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

### Q1: æ¥å£å“åº”æ…¢æ€ä¹ˆåŠï¼Ÿ
**A**: æ­£å¸¸å“åº”æ—¶é—´30-60ç§’ï¼Œè¶…è¿‡2åˆ†é’Ÿæ‰ç®—è¶…æ—¶ã€‚å¯ä»¥ï¼š
1. å‰ç«¯æ˜¾ç¤º"ç”Ÿæˆä¸­"è¿›åº¦æ¡
2. ä¼˜åŒ–æè¿°é•¿åº¦ï¼ˆå»ºè®®100-500å­—ç¬¦ï¼‰
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q2: å¦‚ä½•æé«˜ç½®ä¿¡åº¦ï¼Ÿ
**A**: æä¾›æ›´å®Œæ•´çš„è¾“å…¥æ•°æ®ï¼š
- å¿…å¡«å­—æ®µåŠ¡å¿…å¡«å†™
- å¯é€‰å­—æ®µå°½é‡å¡«å†™
- æè¿°è¯¦ç»†ä¸”ç»“æ„åŒ–

### Q3: ç”Ÿæˆçš„æ–¹æ¡ˆå¯ä»¥ç›´æ¥æ‰§è¡Œå—ï¼Ÿ
**A**:
- ç½®ä¿¡åº¦ â‰¥ 0.8ï¼šå¯ä½œä¸ºé‡è¦å‚è€ƒ
- ç½®ä¿¡åº¦ 0.6-0.8ï¼šéœ€äººå·¥å®¡æ ¸
- ç½®ä¿¡åº¦ < 0.6ï¼šä»…ä¾›å‚è€ƒï¼Œå»ºè®®é‡æ–°è¾“å…¥

### Q4: æ”¯æŒè¯­éŸ³è¾“å…¥å—ï¼Ÿ
**A**: æ¥å£æœ¬èº«ä¸æ”¯æŒï¼Œä½†å¯ä»¥ï¼š
1. å‰ç«¯é›†æˆè¯­éŸ³è½¬æ–‡å­—ï¼ˆå¦‚ç™¾åº¦ASRï¼‰
2. è½¬æ¢åè°ƒç”¨æœ¬æ¥å£

### Q5: å¦‚ä½•é›†æˆåˆ°ç§»åŠ¨ç«¯ï¼Ÿ
**A**: ä½¿ç”¨ç›¸åŒçš„APIï¼Œæ³¨æ„ï¼š
- ç§»åŠ¨ç«¯ç½‘ç»œå¯èƒ½ä¸ç¨³å®šï¼Œå»ºè®®å¢åŠ é‡è¯•æœºåˆ¶
- è¶…æ—¶æ—¶é—´å¯ä»¥è®¾ç½®ä¸º150ç§’
- å»ºè®®ä½¿ç”¨HTTPSåŠ å¯†ä¼ è¾“

---

## 11. æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| v1.0 | 2025-11-02 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€æ•‘æ´æ–¹æ¡ˆç”Ÿæˆ |

---

## 12. è”ç³»æ”¯æŒ

- **æŠ€æœ¯æ”¯æŒ**: tech-support@emergency.cn
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/your-repo/issues)
- **æ–‡æ¡£æ›´æ–°**: æ¯å‘¨äº”æ›´æ–°

---

**æ–‡æ¡£ç»´æŠ¤**: AIåº”æ€¥å¤§è„‘å›¢é˜Ÿ
**æœ€åå®¡æ ¸**: 2025-11-02
